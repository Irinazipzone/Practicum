![25ce3c10f79f11efbd0256fb0f88a1f7-fotor-202503034486](https://github.com/user-attachments/assets/9d7fef72-c07e-41b3-96a3-a599a44cca37)
# Прогнозирование оттока клиентов в сети отелей «Как в гостях»
В нашем распоряжении данные по бронированию номеров в сети отелей. Чтобы привлечь клиентов, эта сеть отелей добавила на свой сайт возможность забронировать номер без предоплаты. Если клиент отменяет бронирование, то компания терпит убытки. 

**Цель:** Разработать систему предсказания отказа от брони. Если модель предсказывает, что бронь будет отменена, то клиенту будет предлагаеться внести депозит. Размер депозита — 80% от стоимости номера за одни сутки и затрат на разовую уборку. Деньги будут списаны со счёта клиента, если он всё же отменит бронь.

В отеле есть несколько типов номеров. В зависимости от типа номера назначается стоимость за одну ночь. Есть также затраты на уборку. Если клиент снял номер надолго, то убираются каждые два дня. Стоимость номеров отеля:  
категория A: за ночь — 1 000, разовое обслуживание — 400;  
категория B: за ночь — 800, разовое обслуживание — 350;  
категория C: за ночь — 600, разовое обслуживание — 350;  
категория D: за ночь — 550, разовое обслуживание — 150;  
категория E: за ночь — 500, разовое обслуживание — 150;   
категория F: за ночь — 450, разовое обслуживание — 150;  
категория G: за ночь — 350, разовое обслуживание — 150.  

В ценовой политике отеля используются сезонные коэффициенты: весной и осенью цены повышаются на 20%, летом — на 40%.
Убытки отеля в случае отмены брони номера — это стоимость одной уборки и одной ночи с учётом сезонного коэффициента.
На разработку системы прогнозирования заложен бюджет — 400 000. При этом необходимо учесть, что внедрение модели должно окупиться за тестовый период. Затраты на разработку должны быть меньше той выручки, которую система принесёт компании.


**Задачи:**  
- Загрузка данных
- Предобработка и исследовательский анализ данных
- Расчет прибыли 
- Разработка и выбор модели машинного обучения
- Расчет прибыли с учетом депозита

    
**Стек:**  Pandas, Matplotlib, Seaborn, Scikit-learn, Imbalanced-learn, Phik, Pipeline, GridSearchCV

**Модели:** дерево решений, случайный лес, логистическая регрессия

**Метрика качества:** F1-мера, ROC-AUC, ROC-кривая

**Ход работы:**  
- Загрузка данных
- Предобработка данных
- Исследовательский анализ данных
- Расчет прибыли
- Разработка моделей машинного обучения:
  - Подготовка признаков
  - Обучение моделей:
    - Решающее дерево
    - Случайный лес
    - Логистическая регрессия
  - Улучшение модели:
    - Подбор параетров
    - Отбор признаков
- Тестирование модели:
  - Тестирование
  - Расчет прибыли с учетом депозита
- Портрет "ненадежного" клиента
      
**Выводы:**  
В ходе выполнения работы была проведена предобработка данных, исследовательский анализ, разработано три модели машинного обучения и расчитана прибыль сети отелей до внедрения депозита и после.  

Наилучшее качество предсказаний получили по алгоритму 'случайный лес'. Результаты прогнозирования данной модели были использованы для расчета прибыли с внедрением депозита. Разработка системы прогнозирования окупится.  

По результатам исследовательского анализа данных можно сделать следующие выводы о 'ненадежных' клиентах:  
- Наиболее значимый признак в отмене броней - страна клиента. Более 57% броней отменены клиентами из страны Португалия. Также следует обратить внимание на страны: Китай, Турция, Северная Македония, Венгрия, Марокко, Италия, Россия, Бразилия, Люксембург;
- Увеличение времени между датой бронирования и датой заезда увеличивает долю отмен броней. При временном промежутке более 250 дней болишство броней отменяется;  
- При распространении бронирований через туроператоров и турагентов наблюдается высокая доля отмен бронирований;  
- При отсутствии специальных отметок и парковочного места в бронировании высокая доля отмен броней.
